<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="generator" content="pandoc" />

<title>Basic BaSTA</title>

<script src="www/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="www/bootstrap-3.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="www/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="www/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="www/bootstrap-3.3.1/shim/respond.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



</head>

<body>

<div class="container">



<!---
1. Use standard R Markdown.
2. Headings with "##" will be automatically turned into table of contents. Therefore, for longer tutorials please use this facility.
3. Check that R studio will knit into an HTML document.
4. You can contribute the .rmd file via GitHub (https://github.com/jonesor/learn-basta), **to the master branch ONLY**. To do that you must be a collaborator on the repository (contact me with your username), or you can fork the repository and send a pull request (https://help.github.com/articles/using-pull-requests/).
5. Alternatively you can email me the *rmd file and associated files (e.g. any figures/diagrams.)
6. I will then compile the site on my computer and push it to the gh-pages branch (which is where the website lives). You could also do this, but you will need to have Jekyll and pandoc installed.
-->
<h2 id="intro">Introduction</h2>
<p>In the previous section you learned how to format the data ready for analysis using <code>basta</code>. In this section we’ll run through how to fit a simple Gompertz model - the default for BaSTA. This model will not have any covariates - we are simply going to estimate the coefficients of the fitted Gompertz model.</p>
<h2 id="gompertz">Fitting a Gompertz model</h2>
<p>For this section, let’s load the full dataset without errors… Read in the file <code>fixedData.csv</code>, which we will simply call <code>dat</code>…</p>
<pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/fixedData.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</code></pre>
<p>Now you have created a BaSTA-ready data set its time to fit a simple model. In fact, if you successfully finished the last session, you will already have fitted a BaSTA model.</p>
<p>To recap, this is how to do it…</p>
<pre class="sourceCode r"><code class="sourceCode r">gsnc &lt;-<span class="st"> </span><span class="kw">basta</span>(dat, <span class="dt">studyStart =</span> <span class="dv">1970</span>, <span class="dt">studyEnd =</span> <span class="dv">2000</span>)
<span class="co">#&gt; No problems were detected with the data.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Starting simulation to find jump sd&#39;s...  done.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Simulation started...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Total MCMC computing time: 4.22 mins.</span></code></pre>
<p>where, for simplicity we have named the BaSTA output object as <code>gsnc</code> which stands for <em>Gompertz, simple, no covariates</em>.</p>
<p>You will notice that there are only three arguments to this function: the BaSTA data object, and the start and end years of the study. There are of course other arguments to the <code>basta()</code> function (see <code>?basta</code>). The most important ones concern the model structure. The default model, which the above code fits, is a standard Gompertz model with a <code>simple</code> shape. We will discuss the other options in a later section.</p>
<h2 id="visualising-outputs">Visualising the BaSTA outputs</h2>
<p>With BaSTA you can extract the outputs from the BaSTA objects in different ways. You can simply type the name of the object and the built-in function <code>print()</code> will recognise the object and produce the following output</p>
<pre class="sourceCode r"><code class="sourceCode r">gsnc
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; Model                    : GO</span>
<span class="co">#&gt; Shape                    : simple</span>
<span class="co">#&gt; Covars. structure        : fused</span>
<span class="co">#&gt; Minimum age              : 0</span>
<span class="co">#&gt; Cat. covars.             : </span>
<span class="co">#&gt; Cont. covars.            :   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;         Estimate   StdErr Lower95%CI Upper95%CI SerAutocor UpdateRate</span>
<span class="co">#&gt; b0       -3.2070 0.100782   -3.39559    -3.0119     0.6121     0.2536</span>
<span class="co">#&gt; b1        0.1133 0.009139    0.09456     0.1311     0.6482     0.2574</span>
<span class="co">#&gt; pi.1970   0.5015 0.007901    0.48538     0.5164     0.1412     1.0000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Convergence calculations require more than one run. </span>
<span class="co">#&gt; To estimate potential scale reduction run at least two simulations.</span></code></pre>
<p>To get more information, simply use function <code>summary()</code> like this:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(gsnc)
<span class="co">#&gt; </span>
<span class="co">#&gt; Output from BaSTA version 1.9.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; Model                    : GO</span>
<span class="co">#&gt; Shape                    : simple</span>
<span class="co">#&gt; Covars. structure        : fused</span>
<span class="co">#&gt; Minimum age              : 0</span>
<span class="co">#&gt; Cat. covars.             : </span>
<span class="co">#&gt; Cont. covars.            :   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model settings:</span>
<span class="co">#&gt;    niter   burnin thinning     nsim </span>
<span class="co">#&gt;    11000     1001       20        1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Jumps and priors:</span>
<span class="co">#&gt;    Jump.sds Prior.means Prior.sds</span>
<span class="co">#&gt; b0  0.18564       -3.00         1</span>
<span class="co">#&gt; b1  0.01496        0.01         1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mean Kullback-Leibler</span>
<span class="co">#&gt; discrepancy calibration (KLDC):</span>
<span class="co">#&gt; KLDC was not calculated due to insufficient number  of simulations to estimate convergence.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;         Estimate   StdErr Lower95%CI Upper95%CI SerAutocor UpdateRate</span>
<span class="co">#&gt; b0       -3.2070 0.100782   -3.39559    -3.0119     0.6121     0.2536</span>
<span class="co">#&gt; b1        0.1133 0.009139    0.09456     0.1311     0.6482     0.2574</span>
<span class="co">#&gt; pi.1970   0.5015 0.007901    0.48538     0.5164     0.1412     1.0000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Convergence:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Convergence calculations require more than one run. </span>
<span class="co">#&gt; To estimate potential scale reduction run at least two simulations.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; DIC:</span>
<span class="co">#&gt; DIC was not calculated due to insufficient number of simulations to estimate convergence.</span></code></pre>
<p>In addition, the BaSTA object is recognised by function <code>plot()</code>, allowing you to plot different aspects of the outputs. For instance, to visually determine if the MCMC parameter chains or “traces” have converged, simply type:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(gsnc)</code></pre>
<p><img src="figures/unnamed-chunk-6.png" title="plot of chunk unnamed-chunk-6" alt="plot of chunk unnamed-chunk-6" width="384" /></p>
<p>which produces the trace plots for the mortality parameters. To make sure that the recapture probability has converged, use argument <code>trace.name = &quot;pi&quot;</code> as</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(gsnc, <span class="dt">trace.name =</span> <span class="st">&quot;pi&quot;</span>)</code></pre>
<p><img src="figures/unnamed-chunk-7.png" title="plot of chunk unnamed-chunk-7" alt="plot of chunk unnamed-chunk-7" width="384" /></p>
<p>To plot the mortality and survival trajectories, use argument <code>plot.traces = FALSE</code>, which produces the following plot:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(gsnc, <span class="dt">plot.traces =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="figures/unnamed-chunk-8.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="384" /></p>
<p>Finally, you can produce what we call a “fancy plot” that combines the densities of the mortality parameters and the trajectories of mortality and survival into the same plot as</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(gsnc, <span class="dt">fancy =</span> <span class="ot">TRUE</span>)</code></pre>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
